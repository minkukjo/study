(self.webpackChunkstudy=self.webpackChunkstudy||[]).push([[3640],{3905:function(t,e,n){"use strict";n.d(e,{Zo:function(){return p},kt:function(){return A}});var r=n(7294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var s=r.createContext({}),l=function(t){var e=r.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):a(a({},e),t)),n},p=function(t){var e=l(t.components);return r.createElement(s.Provider,{value:e},t.children)},h={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},c=r.forwardRef((function(t,e){var n=t.components,i=t.mdxType,o=t.originalType,s=t.parentName,p=u(t,["components","mdxType","originalType","parentName"]),c=l(n),A=i,k=c["".concat(s,".").concat(A)]||c[A]||h[A]||o;return n?r.createElement(k,a(a({ref:e},p),{},{components:n})):r.createElement(k,a({ref:e},p))}));function A(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var o=n.length,a=new Array(o);a[0]=c;var u={};for(var s in e)hasOwnProperty.call(e,s)&&(u[s]=e[s]);u.originalType=t,u.mdxType="string"==typeof t?t:i,a[1]=u;for(var l=2;l<o;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3108:function(t,e,n){"use strict";n.r(e),n.d(e,{frontMatter:function(){return u},metadata:function(){return s},toc:function(){return l},default:function(){return h}});var r=n(2122),i=n(9756),o=(n(7294),n(3905)),a=["components"],u={id:"spring-security",title:"Spring Security OAuth2 Login"},s={unversionedId:"spring/security/spring-security",id:"spring/security/spring-security",isDocsHomePage:!1,title:"Spring Security OAuth2 Login",description:"Spring Security OAuth2 Client \uadf8 \uae4a\uc740 \uc138\uacc4\ub85c",source:"@site/docs/spring/security/security-flow.md",sourceDirName:"spring/security",slug:"/spring/security/spring-security",permalink:"/study/docs/spring/security/spring-security",editUrl:"https://github.com/minkukjo/study/edit/master/docs/spring/security/security-flow.md",version:"current",lastUpdatedAt:1629810620,formattedLastUpdatedAt:"8/24/2021",frontMatter:{id:"spring-security",title:"Spring Security OAuth2 Login"},sidebar:"mySidebar",previous:{title:"Kotlin JPA \uac1c\ubc1c \uac00\uc774\ub4dc",permalink:"/study/docs/spring/jpa/kotlin-jpa-guide"},next:{title:"00. \uc2a4\ud130\ub514 \uc2dc\uc791\uc758 \uacc4\uae30",permalink:"/study/docs/kubernetes/15steps/00-intro"}},l=[{value:"Spring Security OAuth2 Client \uadf8 \uae4a\uc740 \uc138\uacc4\ub85c",id:"spring-security-oauth2-client-\uadf8-\uae4a\uc740-\uc138\uacc4\ub85c",children:[]},{value:"Security \ud074\ub798\uc2a4 \uc18c\uac1c",id:"security-\ud074\ub798\uc2a4-\uc18c\uac1c",children:[{value:"WebSecurityConfigurerAdapter",id:"websecurityconfigureradapter",children:[]},{value:"OAuth2AuthorizationRequestResolver",id:"oauth2authorizationrequestresolver",children:[]},{value:"OAuth2UserService",id:"oauth2userservice",children:[]}]},{value:"\ub0b4\ubd80 \uad6c\uc870\uc758 \ud750\ub984",id:"\ub0b4\ubd80-\uad6c\uc870\uc758-\ud750\ub984",children:[{value:"OAuth2AuthorizationRequestRedirectFilter",id:"oauth2authorizationrequestredirectfilter",children:[]},{value:"OAuth2LoginAuthenticationFilter",id:"oauth2loginauthenticationfilter",children:[]},{value:"\ud1a0\ud070 \ubc1c\uae09\uc740 \ub300\uccb4 \uc5b4\ub514\uc5d0\uc11c?",id:"\ud1a0\ud070-\ubc1c\uae09\uc740-\ub300\uccb4-\uc5b4\ub514\uc5d0\uc11c",children:[]},{value:"\uc720\uc800 \uc778\uc99d \uc815\ubcf4\ub97c \uc0dd\uc131\ud558\ub294 \uc8fc\uccb4 OAuth2LoginAuthenticationProvider",id:"\uc720\uc800-\uc778\uc99d-\uc815\ubcf4\ub97c-\uc0dd\uc131\ud558\ub294-\uc8fc\uccb4-oauth2loginauthenticationprovider",children:[]},{value:"AuthorizationCode \ubc1c\uae09 \ubc29\uc2dd\uc758 Authentication \uc81c\uacf5\uc790 OAuth2AuthorizationCodeAuthenticationProvider",id:"authorizationcode-\ubc1c\uae09-\ubc29\uc2dd\uc758-authentication-\uc81c\uacf5\uc790-oauth2authorizationcodeauthenticationprovider",children:[]},{value:"OAuth2AccessTokenResponseClient",id:"oauth2accesstokenresponseclient",children:[]},{value:"AuthorizationToken Grant \ubc29\uc2dd\uc758 \ud1a0\ud070 \ubc1c\uae09 \uc8fc\uccb4\uc778 DefaultAuthorizationCodeTokenResponseClient",id:"authorizationtoken-grant-\ubc29\uc2dd\uc758-\ud1a0\ud070-\ubc1c\uae09-\uc8fc\uccb4\uc778-defaultauthorizationcodetokenresponseclient",children:[]}]},{value:"\ucd94\uac00\ub85c \uc54c\uba74 \uc88b\uc740 \uc9c0\uc2dd\ub4e4",id:"\ucd94\uac00\ub85c-\uc54c\uba74-\uc88b\uc740-\uc9c0\uc2dd\ub4e4",children:[]},{value:"\ub0b4\ubd80 \ud0d0\ud5d8 \uc18c\uac10",id:"\ub0b4\ubd80-\ud0d0\ud5d8-\uc18c\uac10",children:[]},{value:"Reference",id:"reference",children:[]}],p={toc:l};function h(t){var e=t.components,n=(0,i.Z)(t,a);return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"spring-security-oauth2-client-\uadf8-\uae4a\uc740-\uc138\uacc4\ub85c"},"Spring Security OAuth2 Client \uadf8 \uae4a\uc740 \uc138\uacc4\ub85c"),(0,o.kt)("p",null,"\ud68c\uc0ac\uc5d0\uc11c \uc0ac\ub0b4 \ud1a0\uc774\ud504\ub85c\uc81d\ud2b8\ub97c \uac1c\ubc1c\ud558\uace0 \uc788\ub2e4."),(0,o.kt)("p",null,"\ub098\ub294 \uc5ec\uae30\uc11c Spring boot + Kotlin + JPA(Query DSL) + Security\uc744 \uc0ac\uc6a9\ud558\uc5ec \uac1c\ubc1c \uc911\uc5d0 \uc788\ub2e4."),(0,o.kt)("p",null,"Kakao i \uacc4\uc815 \ub85c\uadf8\uc778 \uae30\ub2a5\uc744 \uac1c\ubc1c\ud558\uae30 \uc704\ud574 Spring Security OAuth2 Client\ub97c \uc0ac\uc6a9 \uc911\uc778\ub370, \uba87 \uac00\uc9c0 \uad81\uae08\uc99d\uc774 \uc0dd\uaca8 \ub0b4\ubd80 \ucf54\ub4dc\ub97c \ud55c \ubc88 \uc5f4\uc5b4\ubcf4\uc558\ub2e4."),(0,o.kt)("p",null,"\uc2dc\ud050\ub9ac\ud2f0 \ubaa8\ub4c8\uc744 \uc0ac\uc6a9\ud558\uba74 \uac1c\ubc1c\uc790\ub294 \ucd5c\uc18c\ud55c\uc758 \ucf54\ub4dc\ub9cc \uc791\uc131\ud574\ub3c4 Token\uc744 \uc27d\uac8c \ubc1c\uae09 \ubc1b\uc744 \uc218 \uc788\ub2e4."),(0,o.kt)("p",null,"\uadf8\ub807\ub2e4\ubcf4\ub2c8, \ub0b4\ubd80\uac00 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ub418\ub294\uc9c0 \ubaa8\ub974\ub354\ub77c\ub3c4 \uc5b4\ub5bb\uac8c\ub4e0(?) \ub3cc\uc544\uac00\ub294 \ucf54\ub4dc\ub97c \uc791\uc131\ud560 \uc218\ub294 \uc788\ub2e4."),(0,o.kt)("p",null,"\ub098\ub294 \uc774\ub807\uac8c \ube14\ub799\ubc15\uc2a4\ub85c \uac1c\ubc1c\ud558\ub294 \uac83\uc744 \uc88b\uc544\ud558\uc9c0 \uc54a\uc544\uc11c, \ub0b4\uac00 \ucc3e\uc544\ubcf8 \ub0b4\uc6a9\ub4e4\uc744 \uc815\ub9ac\ud574\ub450\uace0\uc790 \ud55c\ub2e4."),(0,o.kt)("h2",{id:"security-\ud074\ub798\uc2a4-\uc18c\uac1c"},"Security \ud074\ub798\uc2a4 \uc18c\uac1c"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uac1c\ubc1c\uc5d0 \uc0ac\uc6a9\ud588\ub358 \ud074\ub798\uc2a4\ub4e4\uc744 \uac04\ub7b5\ud788 \uc815\ub9ac\ud574\ubcf4\uc558\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ud5a5\ud6c4 TokenStore\ub77c\ub358\uc9c0 \ub354 \ucd94\uac00\ub41c\ub2e4\uba74 \ubcf8\ubb38\uc5d0\ub3c4 \ucd94\uac00\ud574\ub193\uc744 \uc0dd\uac01\uc774\ub2e4."))),(0,o.kt)("h3",{id:"websecurityconfigureradapter"},"WebSecurityConfigurerAdapter"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc2dc\ud050\ub9ac\ud2f0\ub294 \uae30\ubcf8\uc801\uc73c\ub85c \uc5ec\ub7ec \uac1c\uc758 Filter Chain\ub4e4\uc774 \ub4f1\ub85d\ub418\uc5b4\uc788\uace0 \uadf8 \uccb4\uc778\ub4e4\uc744 \uac70\uce58\uba74\uc11c \uc778\uc99d \uacfc\uc815\uc744 \uac70\uce58\ub294 \ud504\ub808\uc784\uc6cc\ud06c\uc774\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"WebSecurityConfigurerAdapter"),"\ub294 \uc774 Security Filter Chain\uc744 \uc0ac\uc6a9\ud558\uae30 \uc704\ud55c \uc124\uc815\ub4e4\uc744 \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \uc124\uc815\ud558\ub294 \uc124\uc815 \ud074\ub798\uc2a4\uc774\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc774 \uc124\uc815\uc774\ub77c \ud568\uc740, Security Filter Chain\uc5d0 \uae30\ubcf8\uc801\uc73c\ub85c \uc124\uc815\ub41c \uc124\uc815 \uac12\uc744 \uc758\ubbf8\ud55c\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uac00\ub839 Authorization Server\uc5d0\uc11c \ucf54\ub4dc\ub97c \ubc1b\uc544\uc11c \ub418\ub3cc\uc544\uc62c \ub9ac\ub2e4\uc774\ub809\ud2b8 \uacbd\ub85c\uac00 \ub300\ud45c\uc801\uc778 \uc608\uc774\ub2e4."))),(0,o.kt)("h3",{id:"oauth2authorizationrequestresolver"},"OAuth2AuthorizationRequestResolver"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationRequestRedirectFilter"),"\uc5d0\uc11c \ub3d9\uc791\ud558\ub294 \ud074\ub798\uc2a4\ub85c, ",(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationRequest"),"\ub97c \ub9ac\uc878\ube0c\ud55c\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ub3d9\uc791\uc740, Authorization Server\uc758 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ub85c \uc0ac\uc6a9\uc790\uc758 \uc815\ubcf4\ub97c \ub9ac\ub2e4\uc774\ub809\ud2b8\ud574\uc11c \uc778\uac00 \ucf54\ub4dc \ubd80\uc5ec \ud50c\ub85c\uc6b0\ub97c \uc2dc\uc791\ud558\uae30 \uc704\ud55c ",(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationRequest"),"\ub97c \ub9ac\uc878\ube0c\ud558\ub294 \uc5ed\ud560\uc744 \ub2f4\ub2f9\ud55c\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"path\uac00 ",(0,o.kt)("strong",{parentName:"p"},"/oatuh2/authorization/{registrationId}"),"\uc640 \uc77c\uce58\ud558\ub294\uc9c0\ub97c \ube44\uad50\ud574\uc11c \uc77c\uce58\ud558\ub294 \uacbd\uc6b0 ",(0,o.kt)("strong",{parentName:"p"},"registrationId"),"\ub97c \ucd94\ucd9c\ud558\uace0 \uc774\ub97c \uc0ac\uc6a9\ud574 ClientRegistration\uc744 \uac00\uc838\uc640 ",(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationRequest"),"\ub97c \ube4c\ub4dc\ud55c\ub2e4."))),(0,o.kt)("h3",{id:"oauth2userservice"},"OAuth2UserService"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"UserInfo \uc5d4\ub4dc\ud3ec\uc774\ub2a9\uc5d0\uc11c \ucd5c\uc885 \uc0ac\uc6a9\uc790\uc758 \uc18d\uc131\uc744 \uac00\uc838\uc624\uba70, OAuth2 \ud0c0\uc785\uc758 AuthenticatedPrincipal\uc744 \ub9ac\ud134\ud55c\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc774 \ud074\ub798\uc2a4\ub97c \uc0c1\uc18d\ubc1b\uc544 loadUser \uba54\uc18c\ub4dc\ub97c \uc7ac\uc815\uc758\ud558\uc5ec \uc9c1\uc811 Authorization Server\ub85c \uc720\uc800 \uc815\ubcf4\ub97c \uc870\ud68c, \uc800\uc7a5\ud558\uace0 ",(0,o.kt)("strong",{parentName:"p"},"UserAttribute")," \uc815\ubcf4\ub97c \ub9cc\ub4dc\ub294 \uc791\uc5c5\uc744 \ucee4\uc2a4\ud140\ud560 \uc218 \uc788\ub2e4."))),(0,o.kt)("h2",{id:"\ub0b4\ubd80-\uad6c\uc870\uc758-\ud750\ub984"},"\ub0b4\ubd80 \uad6c\uc870\uc758 \ud750\ub984"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Security\ub97c \uac1c\ubc1c\ud558\uba74\uc11c \ub0b4\ubd80 \ud544\ud130\uac00 \uc5b4\ub5a4\uc2dd\uc73c\ub85c \ub3d9\uc791\ud558\ub294\uc9c0 \uad81\uae08\ud574\uc11c \ucf54\ub4dc\ub97c \ub72f\uc5b4\ubcf4\uc558\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Security\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uacfc\uc815\uc73c\ub85c \ud1a0\ud070\uc744 \ubc1c\uae09\ubc1b\ub294\ub2e4."))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"(Authorization Code Grant\uc758 \uacbd\uc6b0) Authorization\ub85c \uc778\uc99d \ucf54\ub4dc \uc694\uccad (\ubcf4\ud1b5 \ud574\ub2f9 Autohrization Server\uc758 \ub85c\uadf8\uc778 \ud654\uba74\uc73c\ub85c Redirect \ub41c\ub2e4.)")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Redirect\ub97c \ubc1b\uc740 \ud074\ub77c\uc774\uc5b8\ud2b8(\ubcf4\ud1b5 Authorization Server\uc5d0\uc11c Redirect \uc8fc\uc18c\ub97c \ucee4\uc2a4\ud140\ud558\uac8c \uba85\uc2dc\ud560 \uc218 \uc788\ub3c4\ub85d \ud574\uc900\ub2e4.)\uac00 Authorization \uc11c\ubc84\uc5d0\uc11c \ubc1b\uc544\uc628 Code\ub97c \uc0ac\uc6a9\ud574 Authorization Server\ub85c \ud1a0\ud070\uc744 \uc694\uccad\ud55c\ub2e4.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\ubc1b\uc544\uc628 \ud1a0\ud070\uc744 \uc0ac\uc6a9\ud574 \uc778\uc99d\uc774 \ud544\uc694\ud55c \uc11c\ubc84\uc5d0 \uc694\uccad\uc744 \ubcf4\ub0b8\ub2e4."))),(0,o.kt)("p",null,"Security\uc5d0\uc11c\ub294 \uc704\uc640 \uac19\uc740 \uc77c\ub828\uc758 \uacfc\uc815\uc744 \ubcc4\ub3c4\uc758 \ucf54\ub4dc \uad6c\ud604 \uc5c6\uc774 \uc2a4\ubb34\uc2a4\ud558\uac8c \uc9c4\ud589\ud560 \uc218 \uc788\ub3c4\ub85d \uc81c\uacf5\ud574\uc900\ub2e4."),(0,o.kt)("p",null,"OAuth2 Client \uc124\uc815\uc744 \ub05d\ub0b8 \ub4a4, \ube0c\ub77c\uc6b0\uc800\ub97c \ucf1c\uc11c ",(0,o.kt)("inlineCode",{parentName:"p"},"localhost:8080/oauth2/authorization/{registrationId}"),"\ub97c \uc785\ub825\ud574\ubcf4\uba74 \uc778\uc99d\uc744 \uc704\ud55c \ud1a0\ud070\uc744 \ubc1c\uae09\ubc1b\uae30 \uc704\ud55c \ud504\ub85c\uc138\uc2a4\uac00 \uc9c4\ud589\ub418\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,o.kt)("p",null,"\uc5ec\uae30\uc11c \ub098\ub294 \ub450 \uac00\uc9c0 \uc758\ubb38\uc810\uc774 \uc0dd\uacbc\ub2e4."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Authorization Code"),"\ub97c \ubc1c\uae09\ubc1b\uae30 \uc704\ud55c Redirect\ub294 \ub300\uccb4 \uc5b4\ub514\uc11c \uc9c4\ud589\ub418\ub294 \uac83\uc774\uba70,"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Token"),"\uc740 \ub610 \uc5b4\ub5bb\uac8c \uc5bb\uc5b4\uc624\ub294\uc9c0\uac00 \uad81\uae08\ud588\ub2e4. ( \ub0b4\ubd80\uc801\uc73c\ub85c RestTemplate\uc744 \uc368\uc11c \ud558\ub294\uac74\uc9c0? )"),(0,o.kt)("p",null,"\uc911\uac04 \ub2e8\uacc4\uac00 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud558\ub294\uc9c0\uc5d0 \ub300\ud574\uc11c \uc2a4\ud504\ub9c1 \ucf54\ub4dc\ub97c \uc5f4\uc5b4\ubcf4\uba74\uc11c \uc54c\uc544\ubcf4\ub3c4\ub85d \ud558\uc790."),(0,o.kt)("h3",{id:"oauth2authorizationrequestredirectfilter"},"OAuth2AuthorizationRequestRedirectFilter"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc774 ",(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationRequestRedirectFilter"),"\ub294 ",(0,o.kt)("strong",{parentName:"p"},"OncePerRequestFilter"),"\ub97c \uad6c\ud604\ud558\ub294 \ud544\ud130 \ud074\ub798\uc2a4\uc774\ub2e4. (OncePerRequestFilter\uc5d0 \ub300\ud55c \ub0b4\uc6a9\uc740 ",(0,o.kt)("a",{parentName:"p",href:"https://minkukjo.github.io/framework/2020/12/18/Spring-142/"},"\uc5ec\uae30"),"\ub97c \ucc38\uc870)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ub0b4\ubd80\ub97c \uae4c\ubcf4\uba74 \ub2e4\uc74c\uacfc \uac19\uc740 \ucf54\ub4dc\uac00 \uc874\uc7ac\ud55c\ub2e4."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"}," @Override\n protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n   throws ServletException, IOException {\n  try {\n   OAuth2AuthorizationRequest authorizationRequest = this.authorizationRequestResolver.resolve(request);\n   if (authorizationRequest != null) {\n    this.sendRedirectForAuthorization(request, response, authorizationRequest); // Redirect \ub418\ub294 \ubd80\ubd84\n    return;\n   }\n  }\n        ...\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"OAuth2AuthorizationRequestResolver\uc5d0 \uc758\ud574 \ub9ac\uc878\ube59\ub41c ",(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationRequest"),"\ub97c \ud30c\ub77c\ubbf8\ud130\ub85c \ub358\uc838\uc11c Authorization Server\ub85c \ub9ac\ub2e4\uc774\ub809\ud2b8\ub97c \uc2dc\ud0a8\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Redirect\ub41c \uc11c\ubc84\uc5d0\uc11c \uc778\uc99d\uc774 \ub05d\ub09c \ud6c4 (\uc544\ub9c8\ub3c4 ID,Password \uc785\ub825) \ud574\ub2f9 Authorization Server\uc758 OAuth Client\uc5d0 \uc815\uc758\ub41c Redirect Uri\ub85c \ub9ac\ub2e4\uc774\ub809\ud2b8 \ub418\uac8c \ub41c\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ud544\uc790\uc758 \uacbd\uc6b0 \uc694\uccad\uc744 \ubcf4\ub0c8\ub358 \uc11c\ubc84\ub85c \ub2e4\uc2dc \uc694\uccad\uc744 \ubc1b\uac8c \ud588\uace0, OAuth2 Security\uc5d0\uc11c \uae30\ubcf8\uc73c\ub85c \uc124\uc815\ud558\ub294 \ub9ac\ub2e4\uc774\ub809\ud2b8 \uc8fc\uc18c\ub3c4 \ucee4\uc2a4\ud140 \ud558\uc600\ub2e4."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public static final String DEFAULT_FILTER_PROCESSES_URI = "/login/oauth2/code/*"; // \uae30\ubcf8 \uac12\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\ucf54\ub4dc\uae4c\uc9c0 \ubc1c\uae09\uc774 \uc644\ub8cc\ub418\uc5c8\ub2e4\uba74 \ub2e4\uc74c\uc740 \ud1a0\ud070\uc744 \ubc1c\uae09\ubc1b\uae30 \uc704\ud55c \ud544\ud130\ub85c \uc9c4\uc785\ud55c\ub2e4.")),(0,o.kt)("h3",{id:"oauth2loginauthenticationfilter"},"OAuth2LoginAuthenticationFilter"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"OAuth2LoginAuthenticationFilter\uc758 ",(0,o.kt)("strong",{parentName:"p"},"attemptAuthentication")," \uba54\uc18c\ub4dc\uac00 \ud1a0\ud070\uc744 \ubc1c\uae09\ud558\uace0 Authentication \uac1d\uccb4\ub97c \ubc18\ud658\ud558\ub294 \uac1d\uccb4\uc774\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc5ec\uae30\uc11c ",(0,o.kt)("strong",{parentName:"p"},"Authentication")," \uac1d\uccb4\ub294 \ud55c \ub9c8\ub514\ub85c ",(0,o.kt)("strong",{parentName:"p"},"\uc778\uc99d\ub41c \uc0ac\uc6a9\uc790"),"\ub97c \uc758\ubbf8\ud55c\ub2e4. \ub0b4\ubd80\uc801\uc73c\ub85c\ub294 principal(\uc0ac\uc6a9\uc790 \uc2dd\ubcc4), credentails(\uc8fc\ub85c \ube44\ubc00\ubc88\ud638), authorities(\uc0ac\uc6a9\uc790\uac00 \ubd80\uc5ec\ubc1b\uc740 \uad8c\ud55c)\uc5d0 \ub300\ud55c \uc815\ubcf4\ub97c \uac16\ub294\ub2e4. (\uc608\uc2dc\ub85c\ub294 role\uacfc scope)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc544\ub798\ub294 \uc720\uc800 \uc778\uc99d \uac1d\uccb4\ub97c \uc0dd\uc131\ud558\uace0, \ud1a0\ud070\uc744 \uac00\uc838\uc624\ub294 \ucf54\ub4dc \uc804\ubb38\uc774\ub2e4."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},' @Override\n public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)\n   throws AuthenticationException {\n  MultiValueMap<String, String> params = OAuth2AuthorizationResponseUtils.toMultiMap(request.getParameterMap());\n  if (!OAuth2AuthorizationResponseUtils.isAuthorizationResponse(params)) {\n   OAuth2Error oauth2Error = new OAuth2Error(OAuth2ErrorCodes.INVALID_REQUEST);\n   throw new OAuth2AuthenticationException(oauth2Error, oauth2Error.toString());\n  }\n  OAuth2AuthorizationRequest authorizationRequest = this.authorizationRequestRepository\n    .removeAuthorizationRequest(request, response);\n  if (authorizationRequest == null) {\n   OAuth2Error oauth2Error = new OAuth2Error(AUTHORIZATION_REQUEST_NOT_FOUND_ERROR_CODE);\n   throw new OAuth2AuthenticationException(oauth2Error, oauth2Error.toString());\n  }\n  String registrationId = authorizationRequest.getAttribute(OAuth2ParameterNames.REGISTRATION_ID);\n  ClientRegistration clientRegistration = this.clientRegistrationRepository.findByRegistrationId(registrationId);\n  if (clientRegistration == null) {\n   OAuth2Error oauth2Error = new OAuth2Error(CLIENT_REGISTRATION_NOT_FOUND_ERROR_CODE,\n     "Client Registration not found with Id: " + registrationId, null);\n   throw new OAuth2AuthenticationException(oauth2Error, oauth2Error.toString());\n  }\n  // @formatter:off\n  String redirectUri = UriComponentsBuilder.fromHttpUrl(UrlUtils.buildFullRequestUrl(request))\n    .replaceQuery(null)\n    .build()\n    .toUriString();\n  // @formatter:on\n  OAuth2AuthorizationResponse authorizationResponse = OAuth2AuthorizationResponseUtils.convert(params,\n    redirectUri);\n  Object authenticationDetails = this.authenticationDetailsSource.buildDetails(request);\n  OAuth2LoginAuthenticationToken authenticationRequest = new OAuth2LoginAuthenticationToken(clientRegistration,\n    new OAuth2AuthorizationExchange(authorizationRequest, authorizationResponse));\n  authenticationRequest.setDetails(authenticationDetails);\n  OAuth2LoginAuthenticationToken authenticationResult = (OAuth2LoginAuthenticationToken) this\n    .getAuthenticationManager().authenticate(authenticationRequest);\n  OAuth2AuthenticationToken oauth2Authentication = new OAuth2AuthenticationToken(\n    authenticationResult.getPrincipal(), authenticationResult.getAuthorities(),\n    authenticationResult.getClientRegistration().getRegistrationId());\n  oauth2Authentication.setDetails(authenticationDetails);\n  OAuth2AuthorizedClient authorizedClient = new OAuth2AuthorizedClient(\n    authenticationResult.getClientRegistration(), oauth2Authentication.getName(),\n    authenticationResult.getAccessToken(), authenticationResult.getRefreshToken());\n\n  this.authorizedClientRepository.saveAuthorizedClient(authorizedClient, oauth2Authentication, request, response);\n  return oauth2Authentication;\n }\n')),(0,o.kt)("h3",{id:"\ud1a0\ud070-\ubc1c\uae09\uc740-\ub300\uccb4-\uc5b4\ub514\uc5d0\uc11c"},"\ud1a0\ud070 \ubc1c\uae09\uc740 \ub300\uccb4 \uc5b4\ub514\uc5d0\uc11c?"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ucf54\ub4dc\uac00 \uaf64 \uae38\uae30\ub3c4\ud558\uace0 \uc774\ub807\uac8c \ubd10\uc11c\ub294 \ub3c4\ubb34\uc9c0 \uc5b4\ub514\uc5d0\uc11c \ud1a0\ud070\uc744 \ubc1c\uae09\ud558\ub294\uc9c0 \uc54c\uae30\uac00 \uc5b4\ub824\uc6e0\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ubb34\uc2dd\ud558\uba74 \uc190\ubc1c\uc774 \uace0\uc0dd\ud55c\ub2e4\uace0, \ub3c4\ubb34\uc9c0 \uc54c \uc218\uac00 \uc5c6\uace0 \uad81\uae08\ud558\uae30\ub294 \ud574\uc11c \ud558\ub098 \ud558\ub098 \ub514\ubc84\uadf8\ub97c \ucc0d\uc5b4\uc11c \ud655\uc778\ud574\ubcf8 \uacb0\uacfc,"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"OAuth2LoginAuthenticationToken authenticationResult = (OAuth2LoginAuthenticationToken) this\n    .getAuthenticationManager().authenticate(authenticationRequest);\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"AuthenticationManager"),"\uc758 ",(0,o.kt)("strong",{parentName:"li"},"authenticate")," \uba54\uc18c\ub4dc\uc5d0\uc11c Authorizaiton\uc744 \ud638\ucd9c\ud558\uace0, \ud1a0\ud070\uc744 \uc5bb\uc5b4\uc624\ub294 \uac83\uc73c\ub85c \ud655\uc778\ud558\uc600\ub2e4.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@Override\n public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n  Class<? extends Authentication> toTest = authentication.getClass();\n  AuthenticationException lastException = null;\n  AuthenticationException parentException = null;\n  Authentication result = null;\n  Authentication parentResult = null;\n  int currentPosition = 0;\n  int size = this.providers.size();\n  for (AuthenticationProvider provider : getProviders()) {\n   if (!provider.supports(toTest)) {\n    continue;\n   }\n   if (logger.isTraceEnabled()) {\n    logger.trace(LogMessage.format("Authenticating request with %s (%d/%d)",\n      provider.getClass().getSimpleName(), ++currentPosition, size));\n   }\n   try {\n    result = provider.authenticate(authentication); // \uc5ec\uae30\uc11c \ud638\ucd9c\n    if (result != null) {\n     copyDetails(authentication, result);\n     break;\n    }\n   }\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"AuthenticationProvider"),"\uc758 authenticate \uba54\uc18c\ub4dc\uc758 \uad6c\ud604\uc744 \ubcf4\uba74 \ub0b4\ubd80\uc5d0\uc11c \ud1a0\ud070\uc744 \uc5bb\uc5b4\uc624\ub294 \uacfc\uc815\uc774 \uc788\uc74c\uc744 \uc54c \uc218 \uc788\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"AuthenticationProvider"),"\ub294 \uc5ec\ub7ec \uad6c\ud604\uccb4\uac00 \uc874\uc7ac\ud558\ub294\ub370, \ud1a0\ud070\uc744 \uc5bb\ub294\ub370 \uc0ac\uc6a9\ud558\ub294 Provider\uc758 \uc774\ub984\uc740 ",(0,o.kt)("strong",{parentName:"p"},"OAuth2LoginAuthenticationProvider"),"\uc774\ub2e4."))),(0,o.kt)("h3",{id:"\uc720\uc800-\uc778\uc99d-\uc815\ubcf4\ub97c-\uc0dd\uc131\ud558\ub294-\uc8fc\uccb4-oauth2loginauthenticationprovider"},"\uc720\uc800 \uc778\uc99d \uc815\ubcf4\ub97c \uc0dd\uc131\ud558\ub294 \uc8fc\uccb4 OAuth2LoginAuthenticationProvider"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"public class OAuth2LoginAuthenticationProvider implements AuthenticationProvider {\n    ...\n\n\n @Override\n public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n  OAuth2LoginAuthenticationToken loginAuthenticationToken = (OAuth2LoginAuthenticationToken) authentication;\n        ...\n  OAuth2AuthorizationCodeAuthenticationToken authorizationCodeAuthenticationToken;\n  try {\n   authorizationCodeAuthenticationToken = (OAuth2AuthorizationCodeAuthenticationToken) this.authorizationCodeAuthenticationProvider\n     .authenticate(new OAuth2AuthorizationCodeAuthenticationToken(\n       loginAuthenticationToken.getClientRegistration(),\n       loginAuthenticationToken.getAuthorizationExchange())); // \ud1a0\ud070\uc744 \uc5bb\ub294 \uacf3\uc740 \uc5ec\uae30\n  }\n  ...\n        ...\n        OAuth2User oauth2User = this.userService.loadUser(new OAuth2UserRequest(\n    loginAuthenticationToken.getClientRegistration(), accessToken, additionalParameters));\n       ...\n }\n ...\n}\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc720\uc800 \uc778\uc99d \uc815\ubcf4\uc778 ",(0,o.kt)("strong",{parentName:"p"},"Authentication")," \uac1d\uccb4\ub97c \ub9cc\ub4dc\ub294 \ud575\uc2ec \ub85c\uc9c1\uc744 \ub2f4\ub2f9\ud558\ub294 \ud074\ub798\uc2a4\uac00 \ubc14\ub85c ",(0,o.kt)("strong",{parentName:"p"},"OAuth2LoginAuthenticationProvider"),"\uc774\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"OAuth2LoginAuthenticationProvider"),"\uc758 authenticate \uba54\uc18c\ub4dc\uc5d0 \uc798 \ubcf4\uba74, \ud1a0\ud070 \ubc1c\uae09 \uc774\ud6c4 ",(0,o.kt)("strong",{parentName:"p"},"userService"),"\uc758 ",(0,o.kt)("strong",{parentName:"p"},"loadUser")," \uba54\uc18c\ub4dc\ub97c \ud1b5\ud574 ",(0,o.kt)("strong",{parentName:"p"},"OAuth2User")," \uac1d\uccb4\ub97c \uc5bb\uc5b4\uc624\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"userService"),"\ub294 \uc77c\ubc18\uc801\uc73c\ub85c \uc720\uc800\uac00 \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5\uc744 \ud558\uc5ec \uc0ac\uc6a9\ud558\ub294 \uba54\uc18c\ub4dc\ub85c\uc368, \ub098 \uc5ed\uc2dc \ud68d\ub4dd\ud55c \ud1a0\ud070\uc744 \uc0ac\uc6a9\ud574 Authorization Server\uc5d0 \ud1a0\ud070\uc5d0 \ud574\ub2f9\ud558\ub294 \uc720\uc800 \uc815\ubcf4\ub97c \uc5bb\uc5b4\uc624\ub294 \ub85c\uc9c1\uc744 \uad6c\ud604\ud588\uc5c8\ub2e4."))),(0,o.kt)("h3",{id:"authorizationcode-\ubc1c\uae09-\ubc29\uc2dd\uc758-authentication-\uc81c\uacf5\uc790-oauth2authorizationcodeauthenticationprovider"},"AuthorizationCode \ubc1c\uae09 \ubc29\uc2dd\uc758 Authentication \uc81c\uacf5\uc790 OAuth2AuthorizationCodeAuthenticationProvider"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"public class OAuth2AuthorizationCodeAuthenticationProvider implements AuthenticationProvider {\n\n    ...\n\n @Override\n public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n  ...\n  OAuth2AccessTokenResponse accessTokenResponse = this.accessTokenResponseClient.getTokenResponse(\n    new OAuth2AuthorizationCodeGrantRequest(authorizationCodeAuthentication.getClientRegistration(),\n      authorizationCodeAuthentication.getAuthorizationExchange()));\n  ...\n }\n    ...\n}\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"OAuth2AuthorizationCodeAuthenticationProvider"),"\ub294 AuthorizationCode Grant \ubc29\uc2dd\uc758 ",(0,o.kt)("strong",{parentName:"p"},"Authentication")," \uac1d\uccb4 \uc0dd\uc131\uc744 \uc704\ud55c \uc815\ubcf4\ub97c \uc81c\uacf5\ud574\uc8fc\ub294 \ud074\ub798\uc2a4\uc774\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc774 \ud074\ub798\uc2a4\uc758 ",(0,o.kt)("strong",{parentName:"p"},"authenticate")," \uba54\uc18c\ub4dc \ub0b4\ubd80\uc5d0 ",(0,o.kt)("strong",{parentName:"p"},"getTokenResponse")," \ub77c\ub294 \uba54\uc18c\ub4dc\uac00 \uc788\ub2e4. \uc774 \uba54\uc18c\ub4dc\ub97c \ud0c0\uace0 \ub4e4\uc5b4\uac00\ubcf4\uba74, \ud1a0\ud070\uc744 \ubc1c\ud589\ud558\ub294 \uc778\ud130\ud398\uc774\uc2a4\uc778 ",(0,o.kt)("strong",{parentName:"p"},"OAuth2AccessTokenResponseClient"),"\ub97c \ub9cc\ub0a0 \uc218 \uc788\ub2e4."))),(0,o.kt)("h3",{id:"oauth2accesstokenresponseclient"},"OAuth2AccessTokenResponseClient"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * A strategy for &quot;exchanging&quot; an authorization grant credential (e.g. an\n * Authorization Code) for an access token credential at the Authorization Server\'s Token\n * Endpoint.\n *\n * @author Joe Grandja\n * @since 5.0\n * @see AbstractOAuth2AuthorizationGrantRequest\n * @see OAuth2AccessTokenResponse\n * @see AuthorizationGrantType\n * @see <a target="_blank" href="https://tools.ietf.org/html/rfc6749#section-1.3">Section\n * 1.3 Authorization Grant</a>\n * @see <a target="_blank" href=\n * "https://tools.ietf.org/html/rfc6749#section-4.1.3">Section 4.1.3 Access Token Request\n * (Authorization Code Grant)</a>\n * @see <a target="_blank" href=\n * "https://tools.ietf.org/html/rfc6749#section-4.1.4">Section 4.1.4 Access Token Response\n * (Authorization Code Grant)</a>\n */\n@FunctionalInterface\npublic interface OAuth2AccessTokenResponseClient<T extends AbstractOAuth2AuthorizationGrantRequest> {\n\n /**\n  * Exchanges the authorization grant credential, provided in the authorization grant\n  * request, for an access token credential at the Authorization Server\'s Token\n  * Endpoint.\n  * @param authorizationGrantRequest the authorization grant request that contains the\n  * authorization grant credential\n  * @return an {@link OAuth2AccessTokenResponse} that contains the\n  * {@link OAuth2AccessTokenResponse#getAccessToken() access token} credential\n  * @throws OAuth2AuthorizationException if an error occurs while attempting to\n  * exchange for the access token credential\n  */\n OAuth2AccessTokenResponse getTokenResponse(T authorizationGrantRequest);\n\n}\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc774 \ud074\ub798\uc2a4\uc758 \uc8fc\uc11d\uc744 \uc77d\uc5b4\ubcf4\uba74 \uc54c\uaca0\uc9c0\ub9cc, ",(0,o.kt)("strong",{parentName:"p"},"Authorization Server"),"\uc758 \ud1a0\ud070 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ub85c \uc5d1\uc138\uc2a4 \ud1a0\ud070\uc744 \uc5bb\uc5b4\uc624\uae30 \uc704\ud55c \ud568\uc218\ud615 \uc778\ud130\ud398\uc774\uc2a4\uc774\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc774\ub807\uac8c \uc81c\ub124\ub9ad \ud0c0\uc785\uacfc \uc778\ud130\ud398\uc774\uc2a4\ub85c \uad6c\ud604\ud55c \uc774\uc720\ub294, OAuth Token\uc758 token grant type\uc774 \uc5ec\ub7ec \ubc29\uc2dd\uc774 \uc788\uae30 \ub54c\ubb38\uc5d0 \uac01\uae30 \ub2e4\ub978 \ubc29\uc2dd\uc744 \uc720\uc5f0\ud558\uac8c \uc81c\uacf5\ud558\uae30 \uc704\ud568\uc73c\ub85c \ubcf4\uc778\ub2e4. (\uc2a4\ud504\ub9c1\uc740 \uc544\uc8fc \uac1d\uccb4\uc9c0\ud5a5\uc2a4\ub7fd\uac8c \uc798 \uc124\uacc4\ud55c \ud504\ub808\uc784\uc6cc\ud06c \uc911 \ud558\ub098\uc774\ub2e4.)"))),(0,o.kt)("h3",{id:"authorizationtoken-grant-\ubc29\uc2dd\uc758-\ud1a0\ud070-\ubc1c\uae09-\uc8fc\uccb4\uc778-defaultauthorizationcodetokenresponseclient"},"AuthorizationToken Grant \ubc29\uc2dd\uc758 \ud1a0\ud070 \ubc1c\uae09 \uc8fc\uccb4\uc778 DefaultAuthorizationCodeTokenResponseClient"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public final class DefaultAuthorizationCodeTokenResponseClient\n  implements OAuth2AccessTokenResponseClient<OAuth2AuthorizationCodeGrantRequest> {\n\n private static final String INVALID_TOKEN_RESPONSE_ERROR_CODE = "invalid_token_response";\n\n private Converter<OAuth2AuthorizationCodeGrantRequest, RequestEntity<?>> requestEntityConverter = new OAuth2AuthorizationCodeGrantRequestEntityConverter();\n\n private RestOperations restOperations;\n\n public DefaultAuthorizationCodeTokenResponseClient() {\n  RestTemplate restTemplate = new RestTemplate(\n    Arrays.asList(new FormHttpMessageConverter(), new OAuth2AccessTokenResponseHttpMessageConverter()));\n  restTemplate.setErrorHandler(new OAuth2ErrorResponseErrorHandler());\n  this.restOperations = restTemplate;\n }\n\n @Override\n public OAuth2AccessTokenResponse getTokenResponse(\n   OAuth2AuthorizationCodeGrantRequest authorizationCodeGrantRequest) {\n  Assert.notNull(authorizationCodeGrantRequest, "authorizationCodeGrantRequest cannot be null");\n  RequestEntity<?> request = this.requestEntityConverter.convert(authorizationCodeGrantRequest);\n  ResponseEntity<OAuth2AccessTokenResponse> response = getResponse(request);\n  OAuth2AccessTokenResponse tokenResponse = response.getBody();\n  if (CollectionUtils.isEmpty(tokenResponse.getAccessToken().getScopes())) {\n   // As per spec, in Section 5.1 Successful Access Token Response\n   // https://tools.ietf.org/html/rfc6749#section-5.1\n   // If AccessTokenResponse.scope is empty, then default to the scope\n   // originally requested by the client in the Token Request\n   // @formatter:off\n   tokenResponse = OAuth2AccessTokenResponse.withResponse(tokenResponse)\n     .scopes(authorizationCodeGrantRequest.getClientRegistration().getScopes())\n     .build();\n   // @formatter:on\n  }\n  return tokenResponse;\n }\n\n private ResponseEntity<OAuth2AccessTokenResponse> getResponse(RequestEntity<?> request) {\n  try {\n   return this.restOperations.exchange(request, OAuth2AccessTokenResponse.class);\n  }\n  catch (RestClientException ex) {\n   OAuth2Error oauth2Error = new OAuth2Error(INVALID_TOKEN_RESPONSE_ERROR_CODE,\n     "An error occurred while attempting to retrieve the OAuth 2.0 Access Token Response: "\n       + ex.getMessage(),\n     null);\n   throw new OAuth2AuthorizationException(oauth2Error, ex);\n  }\n }\n\n /**\n  * Sets the {@link Converter} used for converting the\n  * {@link OAuth2AuthorizationCodeGrantRequest} to a {@link RequestEntity}\n  * representation of the OAuth 2.0 Access Token Request.\n  * @param requestEntityConverter the {@link Converter} used for converting to a\n  * {@link RequestEntity} representation of the Access Token Request\n  */\n public void setRequestEntityConverter(\n   Converter<OAuth2AuthorizationCodeGrantRequest, RequestEntity<?>> requestEntityConverter) {\n  Assert.notNull(requestEntityConverter, "requestEntityConverter cannot be null");\n  this.requestEntityConverter = requestEntityConverter;\n }\n\n /**\n  * Sets the {@link RestOperations} used when requesting the OAuth 2.0 Access Token\n  * Response.\n  *\n  * <p>\n  * <b>NOTE:</b> At a minimum, the supplied {@code restOperations} must be configured\n  * with the following:\n  * <ol>\n  * <li>{@link HttpMessageConverter}\'s - {@link FormHttpMessageConverter} and\n  * {@link OAuth2AccessTokenResponseHttpMessageConverter}</li>\n  * <li>{@link ResponseErrorHandler} - {@link OAuth2ErrorResponseErrorHandler}</li>\n  * </ol>\n  * @param restOperations the {@link RestOperations} used when requesting the Access\n  * Token Response\n  */\n public void setRestOperations(RestOperations restOperations) {\n  Assert.notNull(restOperations, "restOperations cannot be null");\n  this.restOperations = restOperations;\n }\n\n}\n\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ub4dc\ub514\uc5b4 \uac01\uace0\uc758 \ub178\ub825 \ub05d\uc5d0 Token API\ub97c \uc694\uccad\ud558\ub294 \ud074\ub798\uc2a4\ub97c \ub9cc\ub0a0 \uc218 \uc788\uac8c \ub418\uc5c8\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc2a4\ud504\ub9c1 \uc5ed\uc2dc \ub0b4\ubd80\uc801\uc73c\ub85c \ud1a0\ud070 \uc694\uccad\uc744 \uc704\ud55c Http Client\ub85c ",(0,o.kt)("strong",{parentName:"p"},"RestTemplate"),"\uc744 \uc0ac\uc6a9\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc7ac\ubc0c\ub294 \uc810\uc740 RestTemplate\uc758 \uc778\ud130\ud398\uc774\uc2a4\uc778 ",(0,o.kt)("strong",{parentName:"p"},"RestOperations"),"\ub97c \ud0c0\uc785\uc73c\ub85c \uac16\ub294\ub370, \uc774\ub294 \ucd94\ud6c4\uc5d0 ",(0,o.kt)("strong",{parentName:"p"},"RestTemplate"),"\uc774 \uc544\ub2cc \ub2e4\ub978 \uad6c\ud604\uccb4\ub3c4 \uc0ac\uc6a9\uc774 \uac00\ub2a5\ud558\ub3c4\ub85d ",(0,o.kt)("strong",{parentName:"p"},"setRestOperations"),"\ub97c \ud1b5\ud574 \ub2e4\ub978 ",(0,o.kt)("strong",{parentName:"p"},"HttpClient"),"\ub3c4 \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \uc720\uc5f0\ud558\uac8c \uc124\uacc4\ud55c \uac83\uc774 \ub208\uc5d0 \ub748\ub2e4. (\ud06c...!!)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uadf8\ub798\uc11c \uc2e4\uc9c8\uc801\uc73c\ub85c Authorization\uc758 \ud1a0\ud070 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ub85c \uc694\uccad\uc744 \ud558\ub294 \ucf54\ub4dc\ub294 \uc544\ub798\uc758 getResponse \uba54\uc18c\ub4dc\uc774\ub2e4."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},' private ResponseEntity<OAuth2AccessTokenResponse> getResponse(RequestEntity<?> request) {\n  try {\n   return this.restOperations.exchange(request, OAuth2AccessTokenResponse.class);\n  }\n  catch (RestClientException ex) {\n   OAuth2Error oauth2Error = new OAuth2Error(INVALID_TOKEN_RESPONSE_ERROR_CODE,\n     "An error occurred while attempting to retrieve the OAuth 2.0 Access Token Response: "\n       + ex.getMessage(),\n     null);\n   throw new OAuth2AuthorizationException(oauth2Error, ex);\n  }\n }\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uc5ec\uae30\uc11c \ud55c \uac00\uc9c0 \ub354, \uc2a4\ud504\ub9c1\uc5d0\uc11c \uc774\ub7ec\ud55c \uc678\ubd80 API\ub97c \ud638\ucd9c\ud558\ub294 \uba54\uc18c\ub4dc\ub97c \ubcc4\ub3c4\uc758 \uba54\uc18c\ub4dc\ub85c \ubf51\uc544\ub0b4\uace0, \uc774\ub984\uc744 ",(0,o.kt)("strong",{parentName:"p"},"getResponse"),"\ub85c \uc900 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ub098\uac19\uc740 \uacbd\uc6b0 \uc774\ub7ec\ud55c \uc678\ubd80 \ud638\ucd9c\ud558\ub294 \uba54\uc18c\ub4dc\uc758 \uacbd\uc6b0 ",(0,o.kt)("strong",{parentName:"p"},"call"),", ",(0,o.kt)("strong",{parentName:"p"},"request"),"\uc640 \uac19\uc774 ",(0,o.kt)("strong",{parentName:"p"},'"\ub0b4\uac00 \ub2e4\ub978 \uc11c\ubc84\uc5d0 \uc694\uccad\uc744 \ud55c\ub2e4"'),"\ub77c\ub294 \uc758\ubbf8\ub85c \uba54\uc18c\ub4dc\uba85\uc744 \uc9c0\uc5c8\ub294\ub370, \uc2a4\ud504\ub9c1\uc758 \uacbd\uc6b0 \uadf8 \ud589\uc704\uac00 \uacb0\uacfc\uc801\uc73c\ub85c ",(0,o.kt)("strong",{parentName:"p"},"\ubb34\uc5c7"),"\uc744 \ud558\uae30 \uc704\ud55c \uac83\uc778\uc9c0\uc5d0 \ub300\ud574\uc11c\ub9cc \uba54\uc18c\ub4dc\uba85\uc744 \uc801\uc5b4\ub193\uc558\ub358 \uc810\uc774 \uc778\uc0c1\uae4a\uc5c8\ub2e4. (\ucc38\uace0\ud574\uc57c\uaca0\ub2e4.)"))),(0,o.kt)("h2",{id:"\ucd94\uac00\ub85c-\uc54c\uba74-\uc88b\uc740-\uc9c0\uc2dd\ub4e4"},"\ucd94\uac00\ub85c \uc54c\uba74 \uc88b\uc740 \uc9c0\uc2dd\ub4e4"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://charsyam.wordpress.com/2018/05/11/%EC%9E%85-%EA%B0%9C%EB%B0%9C-spring-security-oauth%EC%9D%98-redistokenstore%EC%9D%98-%EC%82%AC%EC%9A%A9%EC%9D%80-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%97%90-%EC%A0%81%ED%95%A9%ED%95%98%EC%A7%80-%EC%95%8A/"},"https://charsyam.wordpress.com/2018/05/11/%EC%9E%85-%EA%B0%9C%EB%B0%9C-spring-security-oauth%EC%9D%98-redistokenstore%EC%9D%98-%EC%82%AC%EC%9A%A9%EC%9D%80-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%97%90-%EC%A0%81%ED%95%A9%ED%95%98%EC%A7%80-%EC%95%8A/")),(0,o.kt)("p",null,"\uc704 \uae00\uc744 \ubcf4\uba74, \uc9c0\uae08\uc73c\ub85c \ubd80\ud130 3\ub144\uc804, Spring Security\uc758 RedisTokenStore\uc5d0\uc11c \ud1a0\ud070 \uc815\ubcf4\ub97c List\uc5d0 \uc800\uc7a5\ud558\uace0 \uc120\ud615 \ud0d0\uc0c9\ud558\ub294 \uacbd\uc6b0 O(n)\uc774 \ub418\uc5b4\uc11c \uc774\uc288\uac00 \uc788\ub2e4\uace0 \ub098\uc628\ub2e4."),(0,o.kt)("p",null,"\uc989, \uc720\uc800\uac00 \ub9ce\uc544\uc838\uc11c \ud1a0\ud070\uc774 \ub9ce\uc544\uc9c0\ub294 \uacbd\uc6b0 O(n) \ud0d0\uc0c9\uc774 \ub418\uba74\uc11c \uc720\uc800\uc758 \ud1a0\ud070 \uc720\ubb34\ub97c \uc870\ud68c\ud558\ub294\ub370 \uc0c1\ub2f9\ud55c \uc2dc\uac04\uc774 \uac78\ub9ac\uac8c \ub41c\ub2e4."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/spring-projects/spring-security-oauth/blob/main/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/redis/RedisTokenStore.java"},"https://github.com/spring-projects/spring-security-oauth/blob/main/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/redis/RedisTokenStore.java")),(0,o.kt)("p",null,"\ubc14\ub010 \ucf54\ub4dc\uc5d0\uc120 List\uac00 \uc544\ub2cc Set \uc790\ub8cc\uad6c\uc870\ub97c \uc0ac\uc6a9\ud574\uc11c O(1)\ub85c \uac1c\uc120\ud55c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc5c8\ub2e4."),(0,o.kt)("p",null,"\uc989, \uc9c0\uae08 \ubc84\uc804\uc758 RedisTokenStore\ub294 Redis\ub97c \uc0ac\uc6a9\ud558\uc5ec AccessToken\uc744 \uad00\ub9ac\ud558\ub294 \uac83\uc5d0 \ud2b9\ubcc4\ud55c \uc774\uc288\uac00 \uc5c6\uc73c\ubbc0\ub85c \uc548\uc2ec\ud558\uace0 \uc0ac\uc6a9\ud574\ub3c4 \ub41c\ub2e4."),(0,o.kt)("h2",{id:"\ub0b4\ubd80-\ud0d0\ud5d8-\uc18c\uac10"},"\ub0b4\ubd80 \ud0d0\ud5d8 \uc18c\uac10"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\uae4a\uace0 \uae4a\uc740 Spring \ub0b4\ubd80 \ucf54\ub4dc\ub97c \uad6c\uacbd\ud558\ub294 \uac83\uc740 \uc7ac\ubc0c\uc5c8\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ub610\ud55c \uc2a4\ud504\ub9c1\uc740 \ud070 \ud504\ub85c\uc81d\ud2b8\uc774\uace0 \ub9ce\uc740 \uac1c\ubc1c\uc790\ub4e4\uc774 \uae30\uc5ec\ud574\uc11c \uadf8\ub7f0\uc9c0 \ucf54\ub4dc\uac00 \uac1d\uccb4\uc9c0\ud5a5 \uc124\uacc4\ub97c \uc798 \uc9c0\ud0a4\uace0 \uc788\uace0, \uae54\ub054\ud558\uac8c \uad6c\uc131\ub418\uc5b4 \uc788\uc5b4\uc11c \uc77d\uae30\uac00 \uc88b\uc558\ub2e4.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ubaa8\ub974\ub294\uac74 \ub300\ubd80\ubd84 \ub3c4\ud050\uba3c\ud2b8\uc5d0 \ub0b4\uc6a9\uc774 \uc788\ub354\ub77c.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\ud55c\uad6d\uc5d0 \uc2a4\ud504\ub9c1 \uc2dc\ud050\ub9ac\ud2f0\uc5d0 \uad00\ud55c \ucc45\uc740 \uc65c \uc5c6\uc744\uae4c? \uc544\uc27d\ub2e4."))),(0,o.kt)("h2",{id:"reference"},"Reference"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-security/site/docs/current/reference/html5/"},"https://docs.spring.io/spring-security/site/docs/current/reference/html5/")))}h.isMDXComponent=!0}}]);