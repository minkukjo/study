(self.webpackChunkstudy=self.webpackChunkstudy||[]).push([[9265],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return d}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=p(n),d=r,y=m["".concat(s,".").concat(d)]||m[d]||c[d]||i;return n?a.createElement(y,l(l({ref:t},u),{},{components:n})):a.createElement(y,l({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4515:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},metadata:function(){return s},toc:function(){return p},default:function(){return c}});var a=n(2122),r=n(9756),i=(n(7294),n(3905)),l=["components"],o={id:"kotlin-jpa-guide",title:"Kotlin JPA \uac1c\ubc1c \uac00\uc774\ub4dc"},s={unversionedId:"spring/jpa/kotlin-jpa-guide",id:"spring/jpa/kotlin-jpa-guide",isDocsHomePage:!1,title:"Kotlin JPA \uac1c\ubc1c \uac00\uc774\ub4dc",description:"JPA With Kotlin",source:"@site/docs/spring/jpa/kotlin-jpa-guide.md",sourceDirName:"spring/jpa",slug:"/spring/jpa/kotlin-jpa-guide",permalink:"/study/docs/spring/jpa/kotlin-jpa-guide",editUrl:"https://github.com/minkukjo/study/edit/master/docs/spring/jpa/kotlin-jpa-guide.md",version:"current",lastUpdatedAt:1628848997,formattedLastUpdatedAt:"8/13/2021",frontMatter:{id:"kotlin-jpa-guide",title:"Kotlin JPA \uac1c\ubc1c \uac00\uc774\ub4dc"},sidebar:"mySidebar",previous:{title:"\uc18c\uac1c",permalink:"/study/docs/intro"},next:{title:"Spring Security OAuth2 Login",permalink:"/study/docs/spring/security/spring-security-flow"}},p=[{value:"JPA With Kotlin",id:"jpa-with-kotlin",children:[{value:"JPA With Kotlin Gradle.kt \uc124\uc815",id:"jpa-with-kotlin-gradlekt-\uc124\uc815",children:[]},{value:"Entity",id:"entity",children:[]},{value:"\uc9c0\uc5f0\ub85c\ub529",id:"\uc9c0\uc5f0\ub85c\ub529",children:[]},{value:"\uc11c\ube44\uc2a4 - \ub808\ud3ec\uc9c0\ud1a0\ub9ac \uacc4\uce35\uc5d0\uc11c \uc911\ubcf5 \ucf54\ub4dc \uc81c\uac70\ud574\ubcf4\uae30",id:"\uc11c\ube44\uc2a4---\ub808\ud3ec\uc9c0\ud1a0\ub9ac-\uacc4\uce35\uc5d0\uc11c-\uc911\ubcf5-\ucf54\ub4dc-\uc81c\uac70\ud574\ubcf4\uae30",children:[]},{value:"Mapped Super Class\ub97c \ud1b5\ud55c \uc911\ubcf5 \ucf54\ub4dc \uc81c\uac70",id:"mapped-super-class\ub97c-\ud1b5\ud55c-\uc911\ubcf5-\ucf54\ub4dc-\uc81c\uac70",children:[]}]},{value:"Repository",id:"repository",children:[{value:"\uba54\uc18c\ub4dc \uac00\uc774\ub4dc",id:"\uba54\uc18c\ub4dc-\uac00\uc774\ub4dc",children:[]}]},{value:"Pageable",id:"pageable",children:[]},{value:"Pageable \uc0ac\uc6a9\uc2dc \uc8fc\uc758\uc810",id:"pageable-\uc0ac\uc6a9\uc2dc-\uc8fc\uc758\uc810",children:[]},{value:"QueryDSL",id:"querydsl",children:[{value:"Gradle Kotlin DSL",id:"gradle-kotlin-dsl",children:[]},{value:"Config",id:"config",children:[]},{value:"QuerydslCustomRepositorySupport\uc758 \uc0ac\uc6a9",id:"querydslcustomrepositorysupport\uc758-\uc0ac\uc6a9",children:[]},{value:"QuerydslCustomRepositorySupport\uc758 \uc0ac\uc6a9 \uc2dc\uc810",id:"querydslcustomrepositorysupport\uc758-\uc0ac\uc6a9-\uc2dc\uc810",children:[]},{value:"N+1 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud55c fetch join \uc0ac\uc6a9\ubc95",id:"n1-\ubb38\uc81c\ub97c-\ud574\uacb0\ud558\uae30-\uc704\ud55c-fetch-join-\uc0ac\uc6a9\ubc95",children:[]}]}],u={toc:p};function c(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"jpa-with-kotlin"},"JPA With Kotlin"),(0,i.kt)("h3",{id:"jpa-with-kotlin-gradlekt-\uc124\uc815"},"JPA With Kotlin Gradle.kt \uc124\uc815"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'plugins {\n    ...\n    kotlin("plugin.jpa") version "1.5.21" // 1\n  id ("org.jetbrains.kotlin.plugin.allopen") version "1.5.21" // 6\n  id ("org.jetbrains.kotlin.plugin.noarg") version "1.5.21" // 7\n}\n\nnoArg {\n    annotation("javax.persistence.Entity") // 2\n}\n\nallOpen {\n    annotation("javax.persistence.Entity") // 3\n    annotation("javax.persistence.MappedSuperclass") // 4\n    annotation("javax.persistence.Embeddable") // 5\n}\n')),(0,i.kt)("p",null,"1 : JPA \uc0ac\uc6a9\uc744 \uc704\ud55c \ud50c\ub7ec\uadf8\uc778 \ucd94\uac00 \uc635\uc158\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"2 : Entity \uc560\ub178\ud14c\uc774\uc158\uc774 \ubd99\uc740 \ucf54\ud2c0\ub9b0 \ud074\ub798\uc2a4\uc758 NoArgument \uc0dd\uc131\uc790 \uc790\ub3d9 \uc0dd\uc131\uc744 \uc704\ud55c \uc124\uc815\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"3 : Entity \uc560\ub178\ud14c\uc774\uc158\uc774 \ubd99\uc740 \ucf54\ud2c0\ub9b0\uc758 \ud074\ub798\uc2a4\ub97c open \ud074\ub798\uc2a4\ub85c \ub9cc\ub4e4\uc5b4\uc8fc\ub294 \uc124\uc815\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"4 : MappedSuperclass \uc560\ub178\ud14c\uc774\uc158\uc774 \ubd99\uc740 \ucf54\ud2c0\ub9b0\uc758 \ud074\ub798\uc2a4\ub97c open \ud074\ub798\uc2a4\ub85c \ub9cc\ub4e4\uc5b4\uc8fc\ub294 \uc124\uc815\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"5 : Embeddable \uc560\ub178\ud14c\uc774\uc158\uc774 \ubd99\uc740 \ucf54\ud2c0\ub9b0 \ud074\ub798\uc2a4\ub97c open \ud074\ub798\uc2a4\ub85c \ub9cc\ub4e4\uc5b4\uc8fc\ub294 \uc124\uc815\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"6 : allOpen\uc5d0 \uc9c0\uc815\ud55c \uc5b4\ub178\ud14c\uc774\uc158\uc73c\ub85c \ub9cc\ub4e0 \ud074\ub798\uc2a4\uc5d0 open \ud0a4\uc6cc\ub4dc\ub97c \uc801\uc6a9\ud574\uc90d\ub2c8\ub2e4."),(0,i.kt)("p",null,"7 : \uc790\ub3d9\uc73c\ub85c Entity, Embeddable, MappedSuperClass \uc5b4\ub178\ud14c\uc774\uc158\uc774 \ubd99\uc5b4\uc788\ub294 \ud074\ub798\uc2a4\uc5d0 \uc790\ub3d9\uc73c\ub85c no-arg \uc0dd\uc131\uc790\ub97c \uc0dd\uc131\ud574\uc90d\ub2c8\ub2e4."),(0,i.kt)("h3",{id:"entity"},"Entity"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'import java.time.ZonedDateTime\nimport javax.persistence.*\n\n@Entity // 1\n@Table(name = "space_conversations")\nclass SpaceConversation ( // 2\n\n \xa0 \xa0@Id // 3\n \xa0 \xa0@GeneratedValue(strategy = GenerationType.IDENTITY) // 4\n \xa0 \xa0var id: Long? = null,\n\n \xa0 \xa0@Column(name = "secret")\n \xa0 \xa0var secret: String? = null,\n\n \xa0 \xa0@ManyToOne(fetch = FetchType.LAZY) // 5\n \xa0 \xa0@JoinColumn(name = "space_id")\n \xa0 \xa0var space: Space,\n\n \xa0 \xa0@ManyToOne(fetch = FetchType.LAZY)\n \xa0 \xa0@JoinColumn(name = "conversation_id")\n \xa0 \xa0var conversation: Conversation,\n\n \xa0 \xa0@Column(name = "inserted_at")\n \xa0 \xa0var insertedAt: ZonedDateTime? = ZonedDateTime.now(),\n\n \xa0 \xa0@Column(name = "updated_at")\n \xa0 \xa0var updatedAt: ZonedDateTime? = ZonedDateTime.now(),\n\n  @Convert(converter = UserStatusConverter::class) // 6\n    @Column(name = "status")\n    var status: UserStatus? = UserStatus.ACTIVATED,\n)\n\nenum class UserStatus(val status: String) { // 7\n    ACTIVATED("activated"),\n    DEACTIVATED("deactivated"),\n    INACTIVATED("inactivated"),\n    INOPERATIVE("inoperative"),\n    ;\n}\n@Converter\nclass UserStatusConverter : AttributeConverter<UserStatus, String> {\n    override fun convertToDatabaseColumn(UserStatus: com.kakaoenterprise.kakaowork.gate.message.enum.UserStatus): String {\n        return UserStatus.status\n    }\n\n    override fun convertToEntityAttribute(value: String): com.kakaoenterprise.kakaowork.gate.message.enum.UserStatus {\n        return com.kakaoenterprise.kakaowork.gate.message.enum.UserStatus.valueOf(value.toUpperCase())\n    }\n}\n')),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Class \uc124\uba85"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\uba3c\uc800 \ucf54\ud2c0\ub9b0\uc5d0\uc11c Entity \ud074\ub798\uc2a4\ub97c \uc791\uc131\ud560 \ub54c\ub294 ",(0,i.kt)("inlineCode",{parentName:"li"},"data class")," \ub85c \uc120\uc5b8 \ud558\ub294 \uac83\ubcf4\ub2e4\ub294 \uc77c\ubc18 \ud074\ub798\uc2a4\ub85c \uc120\uc5b8\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4. \uadf8 \uc774\uc720\ub294, ",(0,i.kt)("inlineCode",{parentName:"li"},"data class")," \ub294 ",(0,i.kt)("inlineCode",{parentName:"li"},"open")," \ud639\uc740 ",(0,i.kt)("inlineCode",{parentName:"li"},"abstract"),"\uc640 \uac19\uc740 \ud0a4\uc6cc\ub4dc\ub97c \ud5c8\uc6a9\ud560 \uc218 \uc5c6\uc73c\ubbc0\ub85c \ubd80\ubaa8\ud074\ub798\uc2a4\uac00 \ub418\uc9c0 \ubabb\ud569\ub2c8\ub2e4."),(0,i.kt)("li",{parentName:"ul"},"\uadf8\ub798\uc11c \uc0c1\uc18d\uc131\uc744 \uac00\uc838\uac00\uae30 \uc704\ud568\uacfc, \uc5f0\uad00\ub418\uc5b4\uc788\ub294 \ub2e4\ub978 Entity\uac00 \uc788\ub2e4\uba74 \uc9c0\uc5f0\ub85c\ub529\uc744 \uc704\ud574\uc11c\ub77c\ub3c4 \uc77c\ubc18 ",(0,i.kt)("inlineCode",{parentName:"li"},"class"),"\ub85c \uc120\uc5b8 \ud6c4 ",(0,i.kt)("inlineCode",{parentName:"li"},"open")," \ud0a4\uc6cc\ub4dc\ub97c \ubd99\uc5ec\uc8fc\uc5b4\uc57c \ud569\ub2c8\ub2e4."),(0,i.kt)("li",{parentName:"ul"},"top-level \ud074\ub798\uc2a4\uc774\uc5b4\uc57c \ud558\uace0 ",(0,i.kt)("inlineCode",{parentName:"li"},"enum")," \uc774\ub098 ",(0,i.kt)("inlineCode",{parentName:"li"},"interface"),"\ub294 \uc5d4\ud2f0\ud2f0\uac00 \ub420 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"),(0,i.kt)("li",{parentName:"ul"},"final class\ub294 \uc0ac\uc6a9\ud558\uba74 \uc548\ub429\ub2c8\ub2e4.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Entity\ub294 \ubc18\ub4dc\uc2dc public \ud639\uc740 protected\uc758 no-arg \uc0dd\uc131\uc790\ub97c \uac00\uc9c0\uace0 \uc788\uc5b4\uc57c\ud569\ub2c8\ub2e4. \ucd94\uac00\uc801\uc778 \uc0dd\uc131\uc790\ub97c \uac00\uc838\ub3c4\ub429\ub2c8\ub2e4"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"primary key\ub97c \uac00\uc9c0\ub294 \ubcc0\uc218\ub97c \uc120\uc5b8\ud558\ub294 \uac83\uc744 \ub73b\ud569\ub2c8\ub2e4")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"@GeneratedValue \uc5b4\ub178\ud14c\uc774\uc158\uc740 \ud574\ub2f9 Id \uac12\uc744 \uc5b4\ub5bb\uac8c \uc790\ub3d9\uc73c\ub85c\xa0\uc0dd\uc131\ud560\uc9c0 \uc804\ub7b5\uc744 \uc120\ud0dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\uc5f0\uad00\uad00\uacc4 \ub9e4\ud551\uc2dc\uc5d0 Lazy\ub85c\ub529 \uc124\uc815\uc744 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"enum class\ub294 7\ubc88 \uac19\uc740 converter\ub97c \ub9cc\ub4e4\uc5b4\uc11c \uc801\uc6a9\ud574\uc8fc\uc2dc\uba74 \ub429\ub2c8\ub2e4")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"user status enum class\uc785\ub2c8\ub2e4"))),(0,i.kt)("h3",{id:"\uc9c0\uc5f0\ub85c\ub529"},"\uc9c0\uc5f0\ub85c\ub529"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'@Entity\n@Table(name = "meeting_users")\n@IdClass(PK::class)\nclass MeetingUser(\n    ...\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = "user_id")\n    val user: User,\n\n    ...\n)\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@ManyToOne \uc560\ub178\ud14c\uc774\uc158\uc740 \uae30\ubcf8\uac12\uc774 EAGER\uc774\ubbc0\ub85c LAZY \uc9c0\uc5f0\ub85c\ub529\uc73c\ub85c \uc124\uc815\ud569\ub2c8\ub2e4.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JPA\uc5d0\uc11c\ub294 \uc989\uc2dc\ub85c\ub529(EAGER) \ubcf4\ub2e4\ub294 \uc9c0\uc5f0\ub85c\ub529(LAZY)\uc758 \uc0ac\uc6a9\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4."))),(0,i.kt)("h3",{id:"\uc11c\ube44\uc2a4---\ub808\ud3ec\uc9c0\ud1a0\ub9ac-\uacc4\uce35\uc5d0\uc11c-\uc911\ubcf5-\ucf54\ub4dc-\uc81c\uac70\ud574\ubcf4\uae30"},"\uc11c\ube44\uc2a4 - \ub808\ud3ec\uc9c0\ud1a0\ub9ac \uacc4\uce35\uc5d0\uc11c \uc911\ubcf5 \ucf54\ub4dc \uc81c\uac70\ud574\ubcf4\uae30"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"abstract class BaseService<E : Any, ID : Serializable?>(\n        clazz: KClass<E>,\n        entityManager: EntityManager) : SimpleJpaRepository<E, ID>(clazz.java, entityManager) {\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Service \ub808\uc774\uc5b4 \ub0b4\ubd80\uc5d0\uc11c JPA\uc758 create, findById \ub4f1\uc744 \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \ubcc4\ub3c4\uc758 \uba54\uc18c\ub4dc\ub97c \ub9cc\ub4dc\ub294 \uac83\uc740 \ube44\ud6a8\uc728\uc801\uc785\ub2c8\ub2e4.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"@Service\nclass UserService(\n        private val userRepository: UserRepository,\n        private val entityManager: EntityManager\n) : BaseService<User, Long>(User::class, entityManager) {\n\n    fun findByOrgId(orgId: Long): List<User> {\n        return userRepository.findByOrgId(orgId)\n    }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"SimpleJpaRepository\ub97c \uc0c1\uc18d\ud55c\xa0BaseService\xa0\ucd94\uc0c1 \ud074\ub798\uc2a4\ub97c \ub9cc\ub4e4\uace0, \uc11c\ube44\uc2a4\uac00 \uc774 \ud074\ub798\uc2a4\ub97c \uc0c1\uc18d\ubc1b\ub3c4\ub85d \ud569\ub2c8\ub2e4.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\uc774\ub807\uac8c \ud558\uba74 \ub9e4\ubc88 \uc77c\uc77c\uc774 \uc911\ubcf5 \ucf54\ub4dc\ub97c \uc791\uc131\ud560 \ud544\uc694\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."))),(0,i.kt)("h3",{id:"mapped-super-class\ub97c-\ud1b5\ud55c-\uc911\ubcf5-\ucf54\ub4dc-\uc81c\uac70"},"Mapped Super Class\ub97c \ud1b5\ud55c \uc911\ubcf5 \ucf54\ub4dc \uc81c\uac70"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'@MappedSuperClass\nabstract class BaseEntity {\n\n    val createdAt: LocalDateTime;\n    val updatedAt: LocalDateTime;\n    ...\n}\n\n@Entity\n@Table(name = "users", uniqueConstraints = [UniqueConstraint(columnNames = arrayOf("user_id"))])\nclass User(\n    ...\n): BaseEntity\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"createdAt, updatedAt\uc744 \ubbf8\ub9ac \uc120\uc5b8\ud574\ub450\uace0 Entity \ud558\uc704\uc5d0\uc11c \uc0c1\uc18d\ubc1b\uac8c \ud558\uc5ec \uc911\ubcf5 \ucf54\ub4dc\ub97c \uc81c\uac70\ud569\ub2c8\ub2e4.")),(0,i.kt)("h2",{id:"repository"},"Repository"),(0,i.kt)("p",null,"\uc2a4\ud504\ub9c1\ubd80\ud2b8\uc5d0\uc11c\ub294 Entity\uc758 ",(0,i.kt)("strong",{parentName:"p"},"\uae30\ubcf8\uc801\uc778 CRUD\uac00 \uac00\ub2a5\ud558\ub3c4\ub85d JpaRepository \uc778\ud130\ud398\uc774\uc2a4"),"\ub97c \uc81c\uacf5\ud55c\ub2e4."),(0,i.kt)("p",null,"Spring Data JPA\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 ",(0,i.kt)("strong",{parentName:"p"},"JpaRepository \uc778\ud130\ud398\uc774\uc2a4\ub97c \uc0c1\uc18d"),"\ud558\uc5ec \uc0ac\uc6a9\ud558\uba74 \ub429\ub2c8\ub2e4"),(0,i.kt)("h3",{id:"\uba54\uc18c\ub4dc-\uac00\uc774\ub4dc"},"\uba54\uc18c\ub4dc \uac00\uc774\ub4dc"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"@Repository\ninterface UserRepository : JpaRepository<User, Long> {\n\n    fun findAllByVacationStartAtAndVacationEndAtAndPublicKey(userId: Long): MutableList<Users> // worst pratice\n\n  @Query(SELECT u FROM USER u WHERE u.vacationStartAt AND u.vacationEndAt AND u.publicKey)\n    fun findAllByVacationTimeAndPKey(userId: Long): MutableList<Users> // best pratice\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JPA\uc758 \uba54\uc18c\ub4dc\uba85\uc774 34\uae00\uc790 \ucd08\uacfc\ub418\uc9c0 \uc54a\ub3c4\ub85d \uba54\uc18c\ub4dc \uba85 \uae38\uc774\ub97c \uc870\uc808\ud558\ub3c4\ub85d \ud569\ub2c8\ub2e4.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Jpa\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 \uba54\uc18c\ub4dc\uac00 34\uae00\uc790 \ucd08\uacfc\ub420 \uacbd\uc6b0 Query \uc5b4\ub178\ud14c\uc774\uc158\uc744 \ud1b5\ud574\uc11c \uac04\uacb0\ud55c \uba54\uc18c\ub4dc\ub97c \uc4f0\ub294\uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4."))),(0,i.kt)("h2",{id:"pageable"},"Pageable"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"@Repository\ninterface UserRepository : JpaRepository<User, Long> {\n\n    fun findByOrderById(pageable: Pageable): Page<User>\n\n}\n")),(0,i.kt)("p",null,"JPA \ud568\uc218\uc5d0 Pageable \ud0c0\uc785\uc758 \ud30c\ub77c\ubbf8\ud130 \uc785\ub825\uc2dc, \ud398\uc774\uc9d5 \uc815\ubcf4\uac00 \ub4e4\uc5b4\uac11\ub2c8\ub2e4"),(0,i.kt)("p",null,"\uacb0\uacfc\uac12\uc73c\ub85c DB \uacb0\uacfc List \ubc0f \ud398\uc774\uc9d5 \uc815\ubcf4\ub97c \ud568\uaed8 \uc804\ub2ec \ubc1b\uc2b5\ub2c8\ub2e4"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"JPA\uc5d0\uc11c \uacb0\uacfc\uac12\uc744 Entity\ub85c \uae30\ubcf8\uc73c\ub85c \ubc1b\uc73c\ub098 \uc6d0\ud558\ub294 \uacb0\uacfc\ub9cc \ucd94\ucd9c\ud558\uace0 \uc2f6\uc744\ub54c\ub294 VO\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.")),(0,i.kt)("h2",{id:"pageable-\uc0ac\uc6a9\uc2dc-\uc8fc\uc758\uc810"},"Pageable \uc0ac\uc6a9\uc2dc \uc8fc\uc758\uc810"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"@Repository\ninterface UserRepository : JpaRepository<User, Long> {\n\n    fun findByOrderById(pageable: Pageable, Integer totalEleme): Page<User>\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JPA\uc5d0\uc11c \ud398\uc774\uc9d5\uc744 \uc704\ud574 \uae30\ubcf8\uc801\uc73c\ub85c count \ucffc\ub9ac\ub97c \ub0a0\ub9bd\ub2c8\ub2e4.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\ub9e4\ubc88 Count SQL \ucffc\ub9ac\uac00 \uc2e4\ud589\ub418\ub294 \uac83\uc740 \ube44\ud6a8\uc728\uc801\uc774\ubbc0\ub85c \uc804\uccb4 \uc0ac\uc774\uc988\ub97c \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ub808\ubca8\uc5d0\uc11c \ubbf8\ub9ac \uad6c\ud574\ub193\uace0 \ub358\uc9c0\ub3c4\ub85d \ud569\ub2c8\ub2e4."))),(0,i.kt)("h2",{id:"querydsl"},"QueryDSL"),(0,i.kt)("h3",{id:"gradle-kotlin-dsl"},"Gradle Kotlin DSL"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'plugins {\n    ...\n    kotlin("kapt") version "1.5.21" // 1\n}\n\nval queryDSLVersion = "4.4.0"\n\nsourceSets["main"].withConvention(org.jetbrains.kotlin.gradle.plugin.KotlinSourceSet::class) {\n    kotlin.srcDir("$buildDir/generated/source/kapt/main") // 3\n}\n\ndependencies {\n  ...\n\n    // Query DSL\n    implementation("com.querydsl:querydsl-jpa:$queryDSLVersion") // 2\n    kapt("com.querydsl:querydsl-apt:$queryDSLVersion:jpa") // 1\n    kapt("org.springframework.boot:spring-boot-configuration-processor") // 1\n\n  ...\n}\n')),(0,i.kt)("p",null,"1 : kapt\ub294 \ucf54\ud2c0\ub9b0 \ud30c\uc77c\uc758 \uc560\ub178\ud14c\uc774\uc158\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c \uc758\uc874\uc131\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"2 : QueryDSL\uc758 \uc758\uc874\uc131\uc785\ub2c8\ub2e4."),(0,i.kt)("p",null,"3 : QClass\uac00 \uc704\uce58\ud560 \ud3f4\ub354\ub97c \uba85\uc2dc\ud558\uae30 \uc704\ud55c \uc124\uc815\uc785\ub2c8\ub2e4."),(0,i.kt)("h3",{id:"config"},"Config"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"@Configuration\nclass QuerydslConfig(\n \xa0 \xa0 \xa0 \xa0val entityManager: EntityManager\n\n) {\n \xa0 \xa0@Bean\n \xa0 \xa0fun jpaQueryFactory(): JPAQueryFactory {\n \xa0 \xa0 \xa0 \xa0return JPAQueryFactory(entityManager)\n \xa0  }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Repository\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"li"},"JPAQueryFactory"),"\ub97c \uc8fc\uc785\ubc1b\uc544 Querydsl\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \ud569\ub2c8\ub2e4.")),(0,i.kt)("h3",{id:"querydslcustomrepositorysupport\uc758-\uc0ac\uc6a9"},"QuerydslCustomRepositorySupport\uc758 \uc0ac\uc6a9"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"abstract class QuerydslCustomRepositorySupport(domainClass: Class<*>) : QuerydslRepositorySupport(domainClass) {\n\n    private var queryFactory: JPAQueryFactory by Delegates.notNull()\n\n    @PersistenceContext\n    override fun setEntityManager(entityManager: EntityManager) {\n        super.setEntityManager(entityManager)\n        this.queryFactory = JPAQueryFactory(entityManager)\n    }\n\n    protected fun <T> select(expr: Expression<T>): JPAQuery<T> {\n        return queryFactory.select(expr)\n    }\n\n    protected fun <T> selectFrom(from: EntityPath<T>): JPAQuery<T> {\n        return queryFactory.selectFrom(from)\n    }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"QuerydslRepositorySupport\ub294 from \uad6c\ubb38\uc73c\ub85c \uc2dc\uc791\ud569\ub2c8\ub2e4."),(0,i.kt)("li",{parentName:"ul"},"\uc77c\ubc18\uc801\uc778 Query\ub294 Select\ubd80\ud130 \uc2dc\uc791\ud569\ub2c8\ub2e4."),(0,i.kt)("li",{parentName:"ul"},"\ucf54\ub4dc\uc758 \uac00\ub3c5\uc131\uc744 \uc704\ud574 QuerydslRepositorySupport \ubcf4\ub2e4\ub294 \ucee4\uc2a4\ud140\ud55c Querydsl\uc744 \ub9cc\ub4e4\uc5b4 \uc0ac\uc6a9\ud569\uc2dc\ub2e4.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"interface PaymentRepository : JpaRepository<Payment, Long>, PaymentCustomRepository {\n}\n\ninterface PaymentCustomRepository {\n    fun findUseSelectFrom(targetAmount: BigDecimal): List<Payment>\n    fun findUseSelect(targetAmount: BigDecimal): List<Long>\n    fun findUseFrom(targetAmount: BigDecimal): List<Payment>\n}\n\nclass PaymentCustomRepositoryImpl : QuerydslCustomRepositorySupport(Payment::class.java), PaymentCustomRepository {\n\n    override fun findUseFrom(targetAmount: BigDecimal): List<Payment> {\n        return from(qPayment)\n            .where(qPayment.amount.gt(targetAmount))\n            .fetch()\n    }\n\n    override fun findUseSelectFrom(targetAmount: BigDecimal): List<Payment> {\n        return selectFrom(qPayment)\n            .where(qPayment.amount.gt(targetAmount))\n            .fetch()\n    }\n\n    override fun findUseSelect(targetAmount: BigDecimal): List<Long> {\n        return select(qPayment.id)\n            .from(qPayment)\n            .where(qPayment.amount.gt(targetAmount))\n            .fetch()\n    }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\ucd9c\ucc98 : ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/cheese10yun/blog-sample/blob/master/query-dsl/src/main/kotlin/com/example/querydsl/repository/payment/PaymentRepository.kt"},"https://github.com/cheese10yun/blog-sample/blob/master/query-dsl/src/main/kotlin/com/example/querydsl/repository/payment/PaymentRepository.kt"))),(0,i.kt)("h3",{id:"querydslcustomrepositorysupport\uc758-\uc0ac\uc6a9-\uc2dc\uc810"},"QuerydslCustomRepositorySupport\uc758 \uc0ac\uc6a9 \uc2dc\uc810"),(0,i.kt)("p",null,"Querydsl\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubcf5\uc7a1\ud55c join \ucffc\ub9ac\ub97c \uc0ac\uc6a9\ud558\uac70\ub098, @Query \uc560\ub178\ud14c\uc774\uc158\uc744 \uc0ac\uc6a9\ud558\uc5ec JPQL\uc744 \uc791\uc131\ud558\ub294 \uacbd\uc6b0, \ub610\ub294 \ub2e4\uc774\ub098\ubbf9 \ucffc\ub9ac\ub97c \uc0ac\uc6a9\ud574\uc57c\ud558\ub294 \uacbd\uc6b0 \uc0ac\uc6a9\ud569\ub2c8\ub2e4."),(0,i.kt)("h3",{id:"n1-\ubb38\uc81c\ub97c-\ud574\uacb0\ud558\uae30-\uc704\ud55c-fetch-join-\uc0ac\uc6a9\ubc95"},"N+1 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud55c fetch join \uc0ac\uc6a9\ubc95"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'@Query("select a from Organization o join fetch o.users")\nList<Organization> findByJoinFetch();\n')),(0,i.kt)("p",null,"N+1 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 JPQL\uc758 join fetch \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."))}c.isMDXComponent=!0}}]);